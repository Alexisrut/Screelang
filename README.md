# Screelang

**Screelang** — это приложение на SwiftUI, которое позволяет пользователю делать снимки, обрабатывать их на сервере и получать обратно обработанные изображения с возможностью выбора языка для дальнейшей интерпретации. Пользователи могут легко делать снимки, видеть их на экране и отправлять на сервер для обработки.

### Основные функции
- **Фотосъёмка в реальном времени**: Использует камеру устройства для создания снимков.
- **Захват и предварительный просмотр**: Фотографии «зависят» на экране, отображая текущий снимок до получения результата обработки.
- **Обработка изображения**: Снимки отправляются на сервер, где обрабатываются с выбранным пользователем языком.
- **Выбор языка**: Позволяет пользователю выбирать язык для обработки изображения, доступный через всплывающее меню.

---

### Установка и запуск

1. **Клонируйте репозиторий:**
   ```bash
   git clone <URL>
   ```

2. **Откройте проект в Xcode** и убедитесь, что на вашем устройстве активировано разрешение на использование камеры.

3. **Настройка сервера**: В коде указана настройка для отправки изображения на сервер. Убедитесь, что сервер доступен по указанному адресу (по умолчанию http://193.160.209.33:8000/detect), или обновите URL в функции `uploadImage`.

---

### Основные классы и компоненты

- **ContentView**: Главный интерфейс, содержащий камеру, меню выбора языка, кнопки съёмки и отображение результата.
- **CameraModel**: Модель для работы с камерой и съемкой.
- **Функция `uploadImage`**: Код обработки данных для отправки фото на сервер и получения ответа с обработанным изображением.

---

### Основной код функций

Приложение использует **SwiftUI** и **AVFoundation** для работы с камерой и **URLSession** для взаимодействия с сервером.

```swift
func uploadImage(image: UIImage, selectedLanguage: String, completion: @escaping (UIImage?) -> Void) {
    guard let url = URL(string: "http://193.160.209.33:8000/detect") else { return }
    var request = URLRequest(url: url)
    request.httpMethod = "POST"

    let boundary = UUID().uuidString
    request.setValue("multipart/form-data; boundary=\(boundary)", forHTTPHeaderField: "Content-Type")

    // Преобразуем фото в корректную ориентацию перед отправкой на сервер
    let fixedImage = image.fixOrientation() 
    guard let imageData = fixedImage.jpegData(compressionQuality: 1) else { return }
    
    // Формируем данные для отправки
    var data = Data()
    // код для добавления данных, включая boundary
    
    // Завершение
    URLSession.shared.uploadTask(with: request, from: data) { responseData, response, error in
        // Обработка ответа сервера
    }.resume()
}
```

### Замечания

1. **Корректная ориентация**: Обработка фото с вертикальной ориентацией с помощью метода `fixOrientation()`.
2. **App Transport Security**: Убедитесь, что ваш Info.plist содержит настройки для разрешения внешнего соединения с сервером.

---

### Контрибьюция

Будем рады улучшениям и предложениям!
